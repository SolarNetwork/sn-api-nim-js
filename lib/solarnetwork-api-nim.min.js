!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("solarnetwork-api-core")):"function"==typeof define&&define.amd?define(["exports","solarnetwork-api-core"],n):n(e.sn=e.sn||{},e.sn)}(this,function(e,n){"use strict";var t=function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")},r=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),o=function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function, not "+typeof n);e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),n&&(Object.setPrototypeOf?Object.setPrototypeOf(e,n):e.__proto__=n)},i=function(e,n){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!n||"object"!=typeof n&&"function"!=typeof n?e:n},s=function(e){if(Array.isArray(e)){for(var n=0,t=Array(e.length);n<e.length;n++)t[n]=e[n];return t}return Array.from(e)},a=function(){function e(n,r){t(this,e),this.componentId=n,this.componentName=r,this.items=[],this.groups=[],this.constructor===e&&Object.freeze(this)}return r(e,[{key:"addItem",value:function(e){return this.items.push(e),this}},{key:"addGroup",value:function(e){return this.groups.push(e),this}},{key:"toJsonEncoding",value:function(){return JSON.stringify(this)}}]),e}(),u=Object.freeze({sensitivity:"base",numeric:!0}),c=function(){function e(n,r,o,i,s){t(this,e),this.id=n,this.sha256=r,this.contentLength=o,this.uncompressedSha256=i,this.uncompressedContentLength=s,this.constructor===e&&Object.freeze(this)}return r(e,[{key:"toJsonEncoding",value:function(){return JSON.stringify(this)}}],[{key:"fromJsonEncoding",value:function(n){var t=[];if(n){var r="string"==typeof n?JSON.parse(n):n;t.push(r.id||""),t.push(r.sha256||""),t.push(r.contentLength||0),t.push(r.uncompressedSha256||""),t.push(r.uncompressedContentLength||0)}return new(Function.prototype.bind.apply(e,[null].concat(t)))}},{key:"compareById",value:function(e,n){var t=e?e.id:"",r=n?n.id:"";return t.localeCompare(r,void 0,u)}},{key:"idComponentGroups",value:function(n){var t=Array.isArray(n)?n.slice():[];t.sort(e.compareById);var r=[],o={};function i(e){for(var n in o)if(0===n.localeCompare(e,void 0,u))return o[n]}for(var s=0,c=t.length;s<c;s+=1){var p=t[s],l=p.id.split("-").slice(0,-1),f=i(l.join("-").toLowerCase());if(void 0===f)for(var h=0,m=l.length;h<m;h+=1){var y=l.slice(0,h+1).join("-").toLowerCase(),d=i(y);d||(d=new a(y,l[h]),o[y]=d,void 0!==f&&f.addGroup(d),0===h&&r.push(d)),f=d}f&&f.addItem(p)}return r}}]),e}(),p="/solarnode-image-maker",l=function(e){return function(a){function u(){for(var e,r=arguments.length,o=Array(r),a=0;a<r;a++)o[a]=arguments[a];t(this,u);var c=o&&o[0]?o[0]instanceof n.Environment?o[0]:new n.Environment(o[0]):new n.Environment({tls:!0,host:"apps.solarnetwork.net",port:443,nimPath:p});return o||(o=[]),o[0]=c,i(this,(e=u.__proto__||Object.getPrototypeOf(u)).call.apply(e,[this].concat(s(o))))}return o(u,e),r(u,[{key:"baseUrl",value:function(){var e=this.env("nimPath")||p;return this.hostUrl()+e+"/api/v1"}},{key:"pingUrl",value:function(){return this.baseUrl()+"/ping"}},{key:"authorizeImageSessionUrl",value:function(){return this.baseUrl()+"/images/authorize"}},{key:"listBaseImagesUrl",value:function(){return this.baseUrl()+"/images/infos"}},{key:"createImageUrl",value:function(e,n){var t=n||this.nimSessionKey;return this.baseUrl()+"/images/create/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)}},{key:"createImageReceiptUrl",value:function(e,n){var t=n||this.nimSessionKey;return this.baseUrl()+"/images/receipt/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)}},{key:"downloadImageUrl",value:function(e,n){var t=n||this.nimSessionKey;return this.baseUrl()+"/images/"+encodeURIComponent(e)+"/"+encodeURIComponent(t)}},{key:"nimSessionKey",get:function(){return this.parameter("nimSessionKey")},set:function(e){this.parameter("nimSessionKey",e)}}]),u}()},f=function(e){function n(){return t(this,n),i(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return o(n,e),n}(l(n.UserUrlHelperMixin(n.UrlHelper)));e.SolarNodeImageGroup=a,e.SolarNodeImageInfo=c,e.NimUrlHelperMixin=l,e.NimDefaultPath=p,e.NimPathKey="nimPath",e.NimApiPathV1="/api/v1",e.NimUrlHelper=f,Object.defineProperty(e,"__esModule",{value:!0})});